(function(n){n.ajaxSetup({cache:!1});window.sessionTimeout=function(t){var i=n.extend({},{tolerance:2,timeLimit:120},t),r=null,u=null,f=0,o=function(){n("#timeoutValue").text(i.timeLimit);n("#timeoutContinue").removeAttr("disabled");n("#timeoutWarning").modal("show");setTimeout(function(){n("#timeoutContinue").focus()},500);u=setInterval(timerDecrement,1e3)},e=function(){f=0;r!==null&&(clearTimeout(r),r=null);u!==null&&(clearTimeout(u),u=null)},s=function(n){if(r===null){var t=0,u=parseInt(n,10);isNaN(u)||(t=u);t>0&&(r=setTimeout(o,(t-(i.tolerance+i.timeLimit))*1e3))}};return timerDecrement=function(){f++;n("#timeoutValue").text(i.timeLimit-f);f>=i.timeLimit&&logOff()},logOff=function(){e();window.location=n("#timeoutLogout").data("action");n("#timeoutContinue").attr("disabled","disabled")},keepAlive=function(){var t=n("#timeoutContinue").data("action"),i=n("#ajax-anti-forgery input[name=__RequestVerificationToken]").val();n.post(t,{__RequestVerificationToken:i},function(){}).error(function(){alert("Unable to continue session. Logging off.");logOff()}).always(function(){n("#timeoutWarning").modal("hide")})},{start:s,stop:e,logOff:logOff,keepAlive:keepAlive}};var t=window.sessionTimeout();t.start(n("#main").data("sessiontimeout"));n("#timeoutLogout").click(function(){t.logOff()});n("#timeoutWarning").on("hidden.bs.modal",function(){t.keepAlive()});n(document).ajaxStart(function(){t.stop()});n(document).ajaxSuccess(function(n,i){i.getResponseHeader("OW_SESSION_TIMEOUT")&&t.start(i.getResponseHeader("OW_SESSION_TIMEOUT"))})})(jQuery);